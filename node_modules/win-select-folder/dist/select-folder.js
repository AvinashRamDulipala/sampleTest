"use strict";var child_process=require("child_process");const selectFolder=({description:e,root:o,newFolderButton:r})=>`\n  function selectFolder {\n    [System.Reflection.Assembly]::LoadWithPartialName("System.windows.forms") | Out-Null\n\n    $form = New-Object System.Windows.Forms.FolderBrowserDialog\n    $form.showNewFolderButton = ${r}\n    $form.rootfolder = '${o}'\n    $form.description = '${e}'\n    $show = $form.showDialog()\n    if ($show -eq "OK"){\n      return $form.selectedPath\n    } else {\n      write-error "cancelled"\n    }\n  }\n\n  $folder = selectFolder\n  write-host $folder\n`;var selectFolder$1=(e={},o)=>new Promise((r,t)=>{const{root:n="desktop",description:s="Select Folder",newFolderButton:l=1}=e,d=child_process.spawn("powershell.exe",[selectFolder({description:s,root:n,newFolderButton:l})]);d.stdout.on("data",e=>{(e=e.toString()).length>1&&(o=e)}),d.stderr.on("data",e=>{(e=e.toString()).includes("cancelled")?r("cancelled"):t(e)}),d.on("exit",()=>{r(o)}),d.stdin.end()});module.exports=selectFolder$1;
